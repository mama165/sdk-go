<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chat-Lab Inspector</title>
    <style>
        :root { --bg: #0d1117; --surface: #161b22; --border: #30363d; --text: #c9d1d9; --accent: #58a6ff; --purple: #bc8cff; --green: #3fb950; --dim: #8b949e; }
        body { background: var(--bg); color: var(--text); font-family: 'JetBrains Mono', 'SFMono-Regular', Consolas, monospace; margin: 0; padding: 15px; font-size: 15px; }

        .filter-bar { display: flex; gap: 12px; align-items: center; margin-bottom: 12px; background: var(--surface); padding: 8px 12px; border-radius: 4px; border: 1px solid var(--border); }
        input { background: #0d1117; border: 1px solid var(--border); color: white; padding: 4px 8px; border-radius: 3px; width: 180px; font-size: 11px; }

        button { cursor: pointer; border: none; padding: 5px 10px; border-radius: 3px; font-weight: bold; color: white; font-size: 10px; text-transform: uppercase; }
        .btn-blue { background: var(--accent); }
        .btn-purple { background: var(--purple); }

        #statusMsg { font-weight: bold; color: var(--green); margin-left: 10px; opacity: 0; transition: 0.3s; }
        #statusMsg.show { opacity: 1; }

        table { width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid var(--border); }
        th { background: #21262d; color: var(--dim); text-align: left; padding: 6px 8px; font-size: 10px; text-transform: uppercase; border-bottom: 2px solid var(--border); }
        td { padding: 4px 8px; border: 1px solid var(--border); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .col-key { color: var(--dim); font-size: 12px; width: 35%; }
        .col-type { font-weight: bold; color: var(--purple); width: 60px; }
        .col-ts { width: 80px; color: var(--text); }
        .col-id { color: var(--accent); width: 80px; }
        .col-ns { width: 100px; }
        .col-detail { color: #e6edf3; }
        .col-scores { color: #d29922; width: 150px; }

        tr:hover { background: rgba(255,255,255,0.03); }
    </style>
</head>
<body>
<div class="filter-bar">
    <strong style="color:var(--accent); margin-right: 10px;">ðŸ§ª CHAT-LAB INSPECTOR</strong>
    <form method="GET" action="/inspect" style="display:flex; gap:5px;">
        <input type="text" name="prefix" value="{{if .Prefix}}{{.Prefix}}{{else}}analysis:{{end}}" placeholder="Prefix...">
        <button type="submit" class="btn-blue">Filter</button>
    </form>
    <button onclick="resumeTest()" class="btn-purple">â–¶ Resume Test</button>
    <span id="statusMsg"></span>
</div>

<table>
    <thead>
    <tr>
        <th class="col-key">Key</th>
        <th class="col-type">Type</th>
        <th class="col-ts">Timestamp</th>
        <th class="col-id">Entity ID</th>
        <th class="col-ns">Namespace</th>
        <th>Detail</th>
        <th class="col-scores">Scores</th>
    </tr>
    </thead>
    <tbody>
    {{range .Items}}
    <tr>
        <td class="col-key" title="{{.Key}}">{{.Key}}</td>
        <td class="col-type">{{.Type}}</td>
        <td class="col-ts">{{.Timestamp}}</td>
        <td class="col-id">{{.EntityID}}</td>
        <td class="col-ns">{{.Namespace}}</td>
        <td class="col-detail" title="{{.Detail}}">{{.Detail}}</td>
        <td class="col-scores">{{.Scores}}</td>
    </tr>
    {{else}}
    <tr style="opacity: 0.5;">
        <td class="col-key">analysis:test-room:1769005374054233000:138a2c68...</td>
        <td class="col-type">AUDIO</td>
        <td class="col-ts">14:22:54</td>
        <td class="col-id">138a2c68</td>
        <td class="col-ns">test-room</td>
        <td class="col-detail">This is a templating example...</td>
        <td class="col-scores">sentiment:0.75</td>
    </tr>
    <tr><td colspan="7" style="text-align:center; padding: 20px; color: var(--dim);">[ No real data - Waiting for Go Test ]</td></tr>
    {{end}}
    </tbody>
</table>

<script>
    function resumeTest() {
        const msg = document.getElementById('statusMsg');
        fetch('/resume').then(r => r.text()).then(t => {
            msg.innerText = "âœ… " + t;
            msg.classList.add('show');
            setTimeout(() => msg.classList.remove('show'), 2000);
        });
    }
</script>
</body>
</html></title>
</head>
<body>

</body>
</html>